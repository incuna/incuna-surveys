!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var e=a("./../libraries.js"),f=a("./../services/calculate-percentage.js"),g=d(f),h=c.moduleProperties={moduleName:"incuna-surveys.calculate-percentage-directive"},i=e.angular.module(h.moduleName,[g.default.moduleName]);i.directive("calculatePercentage",[g.default.componentName,function(a){return{restrict:"A",scope:{questionSet:"=",model:"="},templateUrl:"templates/incuna-surveys/form/calculate-percentage.html",link:function(b){b.percentageComplete="0%";var c=0;b.$watch("questionSet",function(b){c=a.countQuestionsTotal(b)}),b.$watch("model",function(d){if(0!==c){var e=a.countNumberOfAnsweredQuestions(d);b.percentageComplete=a.calculatePercentageComplete(e,c)}},!0)}}}]),c.default=h},{"./../libraries.js":7,"./../services/calculate-percentage.js":11}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var e=a("./../libraries.js"),f=a("./../services/api.js"),g=d(f),h=a("./../services/fieldsets-parser.js"),i=d(h),j=c.moduleProperties={moduleName:"incuna-surveys.form-directive"},k=e.angular.module(j.moduleName,[g.default.moduleName,i.default.moduleName]);k.directive("surveysForm",[g.default.componentName,i.default.componentName,function(a,b){return{restrict:"A",scope:{formUrl:"=",responseUrl:"=",onSuccess:"&",onFailure:"&"},templateUrl:"templates/incuna-surveys/form/survey-form.html",link:function(c){c.model={},c.$watch("formUrl",function(d){d&&a.get(d).then(function(a){c.form=a,c.fields=b.parseFields(a),0===Object.keys(c.model).length&&(c.model=b.parseFormToModel(a))})}),c.$watch("responseUrl",function(b){b&&a.get(b).then(function(a){c.model=a})}),c.submit=function(){c.responseUrl&&a.post(c.responseUrl,c.model).then(function(){b.addFieldErrors(c.fields,{}),c.onSuccess()}).catch(function(a){var d=a&&a.data;b.addFieldErrors(c.fields,d),c.onFailure()})}}}}]),c.default=j},{"./../libraries.js":7,"./../services/api.js":10,"./../services/fieldsets-parser.js":13}],3:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("./../libraries.js"),e={moduleName:"incuna-surveys.integer-field-directive"},f=d.angular.module(e.moduleName,[]);f.directive("ensureInteger",[function(){return{require:"ngModel",restrict:"A",link:function(a,b,c,d){d.$parsers.push(function(a){if(!a)return null;var b=parseInt(a,10);if(!Number.isNaN(b))return b})}}}]),f.directive("integerField",[function(){return{templateUrl:"templates/incuna-surveys/form/integer-field.html",scope:{form:"=",model:"=",id:"="}}}]),c.default=e},{"./../libraries.js":7}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=a("./../libraries.js"),g=a("./../services/proportion-field.js"),h=d(g),i=a("./integer-field.js"),j=d(i),k={moduleName:"incuna-surveys.proportion-field-directive"},l=f.angular.module(k.moduleName,[h.default.moduleName,j.default.moduleName]);l.directive("proportionField",[h.default.componentName,function(a){return{restrict:"A",scope:{form:"=",model:"=",options:"=proportionField"},templateUrl:"templates/incuna-surveys/form/proportion-field.html",link:function(b){var c={maxLimit:100,floor:0,ceil:100,showSelectionBar:!0,hideLimitLabels:!0};b.optionsPerSlider=[],b.fields=[],b.total=0;var d=b.$watch("options",function(e){e&&(e.fieldOptions&&(b.title=e.fieldOptions.label),e.choices&&(b.fields=a.buildFields(e.choices,e.fieldOptions,e.autoId)),b.fields.forEach(function(){b.optionsPerSlider.push(Object.assign({},c))}),d())});b.$watch("options.fieldOptions.errors",function(c){a.addErrors(b.fields,c||{})}),b.$watch("model",function(c,d){if(!c||!d)return void(b.model={});if(!Object.values(c).every(function(a){return null===a})){var f=!0,g=!1,h=void 0;try{for(var i,j=Object.entries(c)[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=e(i.value,2),l=k[0],m=k[1];null===m&&(c[l]=0)}}catch(a){g=!0,h=a}finally{try{!f&&j.return&&j.return()}finally{if(g)throw h}}var n=a.calculateTotal(c);if(b.total=n,n>100){b.total=100;var o=a.getChangedFieldIndex(c,d);b.model[o]-=n-100}b.fields.forEach(function(a,c){b.optionsPerSlider[c].maxLimit=100-n+b.model[c]})}},!0)}}}]),c.default=k},{"./../libraries.js":7,"./../services/proportion-field.js":14,"./integer-field.js":3}],5:[function(a,b,c){angular.module("incuna-surveys-fields.templates",[]).run(["$templateCache",function(a){"use strict";a.put("templates/incuna-surveys/fields/base/checkbox.html",'<div drf-form-field=to.fieldOptions class=checkbox><div ng-repeat="choice in to.choices" class="checkable checkbox"><input class=checkbox-input id="{{ to.autoId }}-{{ $index }}" type=checkbox checklist-model=model[to.fieldSetId][options.key] checklist-value=$index><label class=checkbox-label for="{{ to.autoId }}-{{ $index }}" ng-bind=choice></label></div></div>'),a.put("templates/incuna-surveys/fields/base/free-text.html","<div drf-form-field=to.fieldOptions class=\"text {{ model[to.fieldSetId][options.key] ? 'not-empty' : '' }}\" field-id=to.autoId><input type=text class=text-input id=\"{{ to.autoId }}\" ng-model=model[to.fieldSetId][options.key] ng-required=to.fieldOptions.required></div>"),a.put("templates/incuna-surveys/fields/base/number.html","<div drf-form-field=to.fieldOptions class=\"number {{ model[to.fieldSetId][options.key] ? 'not-empty' : '' }}\" field-id=to.autoId><span integer-field model=model[to.fieldSetId][options.key] id=to.autoId form=form></span></div>"),a.put("templates/incuna-surveys/fields/base/percentage.html","<div drf-form-field=to.fieldOptions class=slider><div aif-slider-input model=model[to.fieldSetId][options.key] ceiling=100 slider-low-label=0% slider-high-label=100%></div></div>"),a.put("templates/incuna-surveys/fields/base/proportion.html","<div class=proportion proportion-field=to form=form model=model[to.fieldSetId][options.key]></div>"),a.put("templates/incuna-surveys/fields/base/radio.html",'<div drf-form-field=to.fieldOptions class=radio><div ng-repeat="choice in to.choices" class="checkable radio"><input class=radio-input type=radio id="{{ to.autoId }}-{{ $index }}" ng-value=$index ng-model=model[to.fieldSetId][options.key] ng-required=to.fieldOptions.required><label class=radio-label for="{{ to.autoId }}-{{ $index }}" ng-bind=choice></label></div></div>'),a.put("templates/incuna-surveys/fields/base/wrapper.html",'<section class="form-section form-section-{{options.templateOptions.id}}"><header class=form-section-header><h3 ng-bind=options.templateOptions.name class=form-section-name></h3><h4 ng-bind=options.templateOptions.description class=form-section-desc></h4></header><fieldset class="form-section-body content"><formly-transclude></formly-transclude></fieldset></section>'),a.put("templates/incuna-surveys/fields/checkbox.html",'<div drf-form-field=to.fieldOptions class=checkbox><div ng-repeat="choice in to.choices" class="checkable checkbox"><input class=checkbox-input id="{{ to.autoId }}-{{ $index }}" type=checkbox checklist-model=model[to.fieldSetId][options.key] checklist-value=$index><label class=checkbox-label for="{{ to.autoId }}-{{ $index }}" ng-bind=choice></label></div></div>'),a.put("templates/incuna-surveys/fields/free-text.html","<div drf-form-field=to.fieldOptions class=\"text {{ model[to.fieldSetId][options.key] ? 'not-empty' : '' }}\" field-id=to.autoId><input type=text class=text-input id=\"{{ to.autoId }}\" ng-model=model[to.fieldSetId][options.key] ng-required=to.fieldOptions.required></div>"),a.put("templates/incuna-surveys/fields/number.html","<div drf-form-field=to.fieldOptions class=\"number {{ model[to.fieldSetId][options.key] ? 'not-empty' : '' }}\" field-id=to.autoId><span integer-field model=model[to.fieldSetId][options.key] id=to.autoId form=form></span></div>"),a.put("templates/incuna-surveys/fields/percentage.html","<div drf-form-field=to.fieldOptions class=slider><div aif-slider-input model=model[to.fieldSetId][options.key] ceiling=100 slider-low-label=0% slider-high-label=100%></div></div>"),a.put("templates/incuna-surveys/fields/proportion.html","<div class=proportion proportion-field=to form=form model=model[to.fieldSetId][options.key]></div>"),a.put("templates/incuna-surveys/fields/radio.html",'<div drf-form-field=to.fieldOptions class=radio><div ng-repeat="choice in to.choices" class="checkable radio"><input class=radio-input type=radio id="{{ to.autoId }}-{{ $index }}" ng-value=$index ng-model=model[to.fieldSetId][options.key] ng-required=to.fieldOptions.required><label class=radio-label for="{{ to.autoId }}-{{ $index }}" ng-bind=choice></label></div></div>'),a.put("templates/incuna-surveys/fields/wrapper.html",'<section class="form-section form-section-{{options.templateOptions.id}}"><header class=form-section-header><h3 ng-bind=options.templateOptions.name class=form-section-name></h3><h4 ng-bind=options.templateOptions.description class=form-section-desc></h4></header><fieldset class="form-section-body content"><formly-transclude></formly-transclude></fieldset></section>')}])},{}],6:[function(a,b,c){angular.module("incuna-surveys-form.templates",[]).run(["$templateCache",function(a){"use strict";a.put("templates/incuna-surveys/form/base/calculate-percentage.html","<div class=percentage-complete-area><p class=percentage ng-bind=percentageComplete></p><span class=complete translate>complete</span></div>"),a.put("templates/incuna-surveys/form/base/integer-field.html",'<input class=integer-input id="{{ id }}" name="{{ id }}" type=text ng-model=model ensure-integer><div class="error-block field-error" ng-show=form[id].$invalid><p class=error><span translate>A valid integer is required.</span></p></div>'),a.put("templates/incuna-surveys/form/base/proportion-field.html",'<span class=title ng-bind=title></span><div class=fields-wrapper><div class=proportion-field ng-repeat="field in fields"><div drf-form-field=field class="proportion-field-inner {{ form[id].$invalid ? \'has-error\' : \'\' }}"><div class=proportion-input integer-field model=model[$index] id=field.id form=form></div><div class=proportion-slider><div clearable-rz-slider model=model[$index] rz-slider-options=optionsPerSlider[$index] slider-low-label=0% slider-high-label=100% ceiling=100></div><span class=allocated-bar style="width: {{ total - model[$index] }}%"></span></div></div></div></div>'),a.put("templates/incuna-surveys/form/base/survey-form.html","<form class=question-form ng-submit=submit()><div calculate-percentage question-set=fields model=model></div><header class=form-header><h1 ng-bind=form.name class=form-name></h1><h2 ng-bind=form.description class=form-desc></h2></header><formly-form class=form-body model=model fields=fields></formly-form><button ng-show=form class=button-submit type=submit translate>Submit</button></form>"),a.put("templates/incuna-surveys/form/calculate-percentage.html","<div class=percentage-complete-area><p class=percentage ng-bind=percentageComplete></p><span class=complete translate>complete</span></div>"),a.put("templates/incuna-surveys/form/integer-field.html",'<input class=integer-input id="{{ id }}" name="{{ id }}" type=text ng-model=model ensure-integer><div class="error-block field-error" ng-show=form[id].$invalid><p class=error><span translate>A valid integer is required.</span></p></div>'),a.put("templates/incuna-surveys/form/proportion-field.html",'<span class=title ng-bind=title></span><div class=fields-wrapper><div class=proportion-field ng-repeat="field in fields"><div drf-form-field=field class="proportion-field-inner {{ form[id].$invalid ? \'has-error\' : \'\' }}"><div class=proportion-input integer-field model=model[$index] id=field.id form=form></div><div class=proportion-slider><div clearable-rz-slider model=model[$index] rz-slider-options=optionsPerSlider[$index] slider-low-label=0% slider-high-label=100% ceiling=100></div><span class=allocated-bar style="width: {{ total - model[$index] }}%"></span></div></div></div></div>'),a.put("templates/incuna-surveys/form/survey-form.html","<form class=question-form ng-submit=submit()><div calculate-percentage question-set=fields model=model></div><header class=form-header><h1 ng-bind=form.name class=form-name></h1><h2 ng-bind=form.description class=form-desc></h2></header><formly-form class=form-body model=model fields=fields></formly-form><button ng-show=form class=button-submit type=submit translate>Submit</button></form>")}])},{}],7:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.angular=window.angular},{}],8:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=a("./libraries.js"),f=a("./services/api.js"),g=d(f),h=a("./services/fields-config.js"),i=d(h),j=a("./directives/form.js"),k=d(j),l=a("./directives/calculate-percentage.js"),m=d(l),n=a("./directives/proportion-field.js"),o=d(n),p=a("./directives/integer-field.js"),q=d(p);e.angular.module("incuna-surveys",["drf-form-field","aif-slider-input","checklist-model",i.default.moduleName,g.default.moduleName,k.default.moduleName,m.default.moduleName,o.default.moduleName,q.default.moduleName])},{"./directives/calculate-percentage.js":1,"./directives/form.js":2,"./directives/integer-field.js":3,"./directives/proportion-field.js":4,"./libraries.js":7,"./services/api.js":10,"./services/fields-config.js":12}],9:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var d=a("./../libraries.js"),e=c.moduleProperties={moduleName:"incuna-surveys.config",componentName:"ProjectConfig"},f=d.angular.module(e.moduleName,[]);f.provider(e.componentName,[function(){var a={apiRoot:"localhost:8000"};return{$get:function(){return a},setApiRoot:function(b){a.apiRoot=b}}}]),c.default=e},{"./../libraries.js":7}],10:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var e=a("./../libraries.js"),f=a("./../providers/project-config.js"),g=d(f),h=c.moduleProperties={moduleName:"incuna-surveys.api",componentName:"API"},i=e.angular.module(h.moduleName,[g.default.moduleName]);i.service(h.componentName,["$http",g.default.componentName,function(a,b){return{getBaseUrl:function(){var a="forms",c=b.apiRoot;return c+"/"+a},getList:function(){var b=this.getBaseUrl();return a.get(b).then(function(a){return a.data})},get:function(b){return a.get(b).then(function(a){return a.data})},post:function(b,c){return a.post(b,c).then(function(a){return a.data})}}}]),c.default=h},{"./../libraries.js":7,"./../providers/project-config.js":9}],11:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var d=a("./../libraries.js"),e=c.moduleProperties={moduleName:"incuna-surveys.calculate-completion-percent",componentName:"calculateCompletionPercent"},f=d.angular.module(e.moduleName,[]);f.service(e.componentName,[function(){var a=[];this.countQuestionsTotal=function(b){var c=0;return d.angular.forEach(b,function(b){d.angular.forEach(b.fieldGroup,function(b){b.templateOptions.fieldOptions.important===!0&&(c+=1,a.push(b.key))})}),c},this.countNumberOfAnsweredQuestions=function(b){var c=0;if(0===a.length)return c;for(var d in b){var e=b[d];for(var f in e){var g=e[f];a.indexOf(parseInt(f))!==-1&&(g&&null!==g||0===g)&&c++}}return c},this.calculatePercentageComplete=function(a,b){var c="0%";if(0===b)return c;var d=a/b*100;return d>=0?Math.round(d)+"%":c}}]),c.default=e},{"./../libraries.js":7}],12:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var d=a("./../libraries.js"),e=c.moduleProperties={moduleName:"incuna-surveys.formly-config",componentName:"FieldsConfig"},f=d.angular.module(e.moduleName,["formly"]);f.service(e.componentName,[function(){this.templatesBase="templates/incuna-surveys/fields"}]),f.run(["formlyConfig",e.componentName,function(a,b){var c=b.templatesBase;a.setType({name:"free_text",templateUrl:c+"/free-text.html"}),a.setType({name:"number",templateUrl:c+"/number.html"}),a.setType({name:"percentage",templateUrl:c+"/percentage.html"}),a.setType({name:"checkbox",templateUrl:c+"/checkbox.html"}),a.setType({name:"radio",templateUrl:c+"/radio.html"}),a.setType({name:"proportion",templateUrl:c+"/proportion.html"}),a.setWrapper([{name:"panel",templateUrl:c+"/wrapper.html"}])}]),c.default=e},{"./../libraries.js":7}],13:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var d=a("./../libraries.js"),e=c.moduleProperties={moduleName:"incuna-surveys.field-parser",componentName:"FieldsParser"},f=d.angular.module(e.moduleName,[]);f.service(e.componentName,[function(){this.parseFields=function(a){return a.fieldsets.map(function(a){return{wrapper:"panel",templateOptions:a,fieldGroup:a.fields.map(function(b){return{key:b.id,type:b.field_type,templateOptions:{fieldSetId:a.id,autoId:"id-"+a.id+"-"+b.id,choices:b.answers,fieldOptions:{help_text:b.help_text,required:b.required,important:b.important,label:b.name}}}})}})},this.parseFormToModel=function(a){var b={};return a.fieldsets.forEach(function(a){b[a.id]={}}),b},this.addFieldErrors=function(a,b){a&&b&&a.forEach(function(a){var c=a.templateOptions.id,d=b[c];a.fieldGroup.forEach(function(a){var b=d&&d[a.key];a.templateOptions.fieldOptions.errors=b})})}}]),c.default=e},{"./../libraries.js":7}],14:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.moduleProperties=void 0;var d=a("./../libraries.js"),e=c.moduleProperties={moduleName:"incuna-surveys.proportion-field",componentName:"proportionField"},f=d.angular.module(e.moduleName,[]);f.service(e.componentName,[function(){this.buildFields=function(a,b,c){return a.map(function(a,d){return Object.assign({},b,{label:a,id:c+"-"+d})})},this.calculateTotal=function(a){return a?Object.keys(a).reduce(function(b,c){var d=parseInt(a[c],10)||0;return b+d},0):0},this.addErrors=function(a,b){a.forEach(function(a,c){a.errors=b[c]})},this.getChangedFieldIndex=function(a,b){var c=Object.values(a),d=Object.values(b);return c.findIndex(function(a,b){return a!==d[b]})}}]),c.default=e},{"./../libraries.js":7}]},{},[1,2,3,4,5,6,7,8,9,10,11,12,13,14]);